[
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX : <ark:/87287/d7gt0q/schema#>\n# PREFIX aggie_enterprise: <ark:/87287/d7c08j/>\nPREFIX expert: <http://experts.ucdavis.edu/expert/>\nPREFIX experts: <http://experts.ucdavis.edu/>\nPREFIX grant: <ark:/87287/d7gt0q/grant/>\nPREFIX iam: <http://iam.ucdavis.edu/>\nPREFIX kfs: <ark:/87287/d7gt0q/>\nPREFIX obo: <http://purl.obolibrary.org/obo/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX rems:  <http://rems.ucop.edu/sponsor#>\nPREFIX schema: <http://schema.org/>\nPREFIX ucdlib: <http://schema.library.ucdavis.edu/schema#>\nPREFIX vcard: <http://www.w3.org/2006/vcard/ns#>\nPREFIX vivo: <http://vivoweb.org/ontology/core#>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\n\n# SELECT DISTINCT ?s\n# WHERE {\n#   GRAPH <http://www.ucdavis.edu/aggie_enterprise/> { ?s ?p ?o } .\n#   FILTER(!isBlank(?s))\n# }\n\n# SELECT DISTINCT ?subject\n# WHERE {\n#   GRAPH <http://www.ucdavis.edu/aggie_enterprise/> {\n#     ?subject ?predicate ?object .\n#     FILTER(!isBlank(?subject))\n#   }\n# }\n\n# select (count(*) as ?cnt) WHERE {\n#        graph <ark:/87287/d7c08j/> {\n#        ?grant a vivo:Grant.\n#        }}\n\n# select ?s ?p ?o WHERE {\n#   GRAPH <http://oapolicy.universityofcalifornia.edu/> { \n#     ?s ?p ?o\n#   }\n# } limit 5\n\nSELECT DISTINCT ?graph\nWHERE {\n  GRAPH ?graph { ?s ?p ?o }\n}\n\n#SELECT DISTINCT ?graph\n# DESCRIBE ?grant \n# WHERE {\n#   GRAPH ?graph { \n#      ?grant a vivo:Grant ;\n#         ?p ?o\n#     }\n# }\n# limit 5\n\n    # PREFIX : <http://www.ucdavis.edu/aggie_enterprise/#>\n    #  select ?status (count(*) as ?cnt) WHERE {\n    #    ?grant :status ?status\n    #    } group by ?status order by ?status\n\n#SELECT * \n# DESCRIBE ?s #?from_grant\n# WHERE {\n#   GRAPH ae: { ?s a vivo:Grant ;\n#               # ucdlib:flowThruFunding ?flowThruFunding ;\n#                    ?p ?o\n#               }\n#    }\n#   # GRAPH kfs: { ?s a vivo:Grant ?p ?o }\n# LIMIT 3\n\n# PREFIX : <http://www.ucdavis.edu/aggie_enterprise#>\n# select  ?g ?type (count(*) as ?cnt)\n# WHERE {\n#   graph ?g {\n#     [] a $type.\n#    }\n#   filter(regex(str(?g),\"^ark:\"))\n# } group by ?g ?type order by ?g ?type",
    "metadata": {}
  },
  {
    "kind": 1,
    "language": "markdown",
    "value": "",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "# Query for grants\nPREFIX : <ark:/87287/d7gt0q/schema#>\n# PREFIX ae: <ark:/87287/d7c08j/>\nPREFIX iam: <http://iam.ucdavis.edu/>\nPREFIX experts: <http://experts.ucdavis.edu/>\nPREFIX grant: <ark:/87287/d7gt0q/grant/>\nPREFIX kfs: <ark:/87287/d7gt0q/>\nPREFIX obo: <http://purl.obolibrary.org/obo/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX ucdlib: <http://schema.library.ucdavis.edu/schema#>\nPREFIX vivo: <http://vivoweb.org/ontology/core#>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\nPREFIX cdl: <http://oapolicy.universityofcalifornia.edu/>\nselect distinct\n(?grant AS ?id)\n(\"grant\" AS ?category)\n(\"c-davis\" AS ?type)\n(\"\" AS ?url)\n(?grant as ?institution_reference)\n?flowThruFunding\n?title\n?pi\n?funding_type\n?start_date\n?end_date\n?ucop_sponsor\n?funder_name\n?funder_reference\n?amount_value\n(\"USD\" AS ?amount_currency_code)\n(\"TRUE\" AS ?visible)\nwhere {\n  GRAPH <ark:/87287/d7c08j/> {\n    ?grant a vivo:Grant,?grant_class ;\n              rdfs:label ?title;\n              # ucdlib:piName ?pi;\n              vivo:totalAwardAmount ?amount_value;\n              vivo:dateTimeInterval [\n                                      vivo:start/vivo:dateTime ?start_date;\n                                      vivo:end/vivo:dateTime ?end_date;\n                                    ];\n    .\n\n    # VALUES (?funding_type ?grant_class) {\n    #   (\"Instruction\" :GrantTypeInstruction)\n    #   (\"Research\" :GrantTypeResearch)\n    #   (\"Service /Other\" :GrantTypeService)\n    #   (\"Academic Support\" :GrantTypeAcademicSupport)\n    #   (\"Student Services\" :GrantTypeStudentService)\n    #   (\"Scholarships / Fellowships\" :GrantTypeScholarship)\n    #   (\"Research\" :GrantTypeDefault)\n    # }\n\n    # OPTIONAL {\n    #   ?grant ucdlib:flowThruFunding ?flowThruFunding.\n    # }\n    \n    OPTIONAL {\n      ?grant vivo:assignedBy ?ucop_sponsor;\n             vivo:sponsorAwardId ?funder_reference;\n             .\n      ?ucop_sponsor rdfs:label ?funder_name.\n    }\n    # # This filters grants without a value oracle_award_number\n    # filter(! regex(str(?grant),\"K-\"))\n  }\n} order by ?id limit 100\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "PREFIX : <ark:/87287/d7gt0q/>\nselect  ?g ?type (count(*) as ?cnt)\nWHERE {\n  graph ?g {\n    [] a $type.\n   }\n  filter(regex(str(?g),\"^ark:\"))\n} group by ?g ?type order by ?g ?type",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "# Query for Grant CDL User links.\n# Note that the CDL graph must be created using the experts-cdl-users script before this query can be successful.\n\nPREFIX : <ark:/87287/d7gt0q/schema#>\nPREFIX experts: <http://experts.ucdavis.edu/>\nPREFIX grant: <ark:/87287/d7gt0q/grant/>\nPREFIX kfs: <ark:/87287/d7gt0q/>\nPREFIX obo: <http://purl.obolibrary.org/obo/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX ucdlib: <http://schema.library.ucdavis.edu/schema#>\nPREFIX vivo: <http://vivoweb.org/ontology/core#>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\nPREFIX iam: <http://iam.ucdavis.edu/>\nPREFIX cdl: <http://oapolicy.universityofcalifornia.edu/>\n\nselect (\"user\" as ?category_1) (?ucpath as ?id_1)\n(\"grant\" as ?category_2) (?grant as ?id_2)\n?link_type_id (\"TRUE\" as ?visible)\n# select *\nWHERE {\n  # VALUES (?role ?link_type_id ?e_role) {\n  #   #       (:GrantAccountManagerRole \"183\" \"Researcher on\" )\n  #   (:GrantOtherRole \"138\" \"Researcher on\" )\n  #   (:GrantProjectLeaderRole \"118\" \"Project Lead of\")\n  #   (:GrantCoPrincipalInvestigatorRole \"121\" \"Co-PI of\")\n  #   (:GrantProgramDirectorRole \"137\" \"Program Director of\")\n  #   (:GrantCoreLeaderRole \"119\" \"Co leader on\")\n  #   (:GrantKeyPersonnelRole \"97\" \"Senior personal of\")\n  #   (:GrantPrincipalInvestigatorRole \"120\" \"Primary investigator for\")\n  # }\n  graph <ark:/87287/d7c08j/> {\n    ?grant a vivo:Grant;\n           vivo:relates ?related;\n           .\n    ?related a ?role ;\n    # obo:RO_0000052 ?expert;\n    .\n    # This filters grants without a value oracle_award_number\n    # filter(! regex(str(?grant),\"K-\"))\n  }\n\n  # GRAPH cdl: {\n\t#   ?expert ucdlib:proprietary_id ?ucpath .\n  # }\n} order by ?id_2 ?id_1\n\nlimit 10\n",
    "metadata": {}
  },
  {
    "kind": 2,
    "language": "sparql",
    "value": "# Query for grant roles\n\nPREFIX : <ark:/87287/d7gt0q/schema#>\nPREFIX experts: <http://experts.ucdavis.edu/>\nPREFIX grant: <ark:/87287/d7gt0q/grant/>\nPREFIX kfs: <ark:/87287/d7gt0q/>\nPREFIX obo: <http://purl.obolibrary.org/obo/>\nPREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>\nPREFIX ucdlib: <http://schema.library.ucdavis.edu/schema#>\nPREFIX vivo: <http://vivoweb.org/ontology/core#>\nPREFIX xsd: <http://www.w3.org/2001/XMLSchema#>\nPREFIX iam: <http://iam.ucdavis.edu/>\nPREFIX cdl: <http://oapolicy.universityofcalifornia.edu/>\n\nselect ?category ?id ?field_name ?surname ?first_name ?full_name ?order_number ?email_address ?phone_number ?full_address ?address_name\n  WHERE {\n    VALUES (?role ?link_type_id ?e_role) {\n       (:GrantCoPrincipalInvestigatorRole \"121\" \"Co-PI of\")\n       (:GrantPrincipalInvestigatorRole \"120\" \"Primary investigator for\")\n     }\n\n    GRAPH <ark:/87287/d7c08j/> {\n        ?grant a vivo:Grant;\n               vivo:relates ?related\n               .\n   \t    ?related a ?role;\n               rdfs:label ?full_name_and_role;\n               obo:RO_0000052 ?expert;\n               .\n    }\n\n  \n# Optional {\n#   graph iam: {\n# \t  ?expert ucdlib:userId ?cas.\n\n#   \t}\n#   }\n  \n  bind(\"grant\" as ?category)\n  bind(?grant as ?id)\n\tbind(\"researchers\" as ?field_name)\n  bind(replace(?full_name_and_role,\"\\\\(.*\\\\)\" ,\"\") as ?temp)\n  bind(replace(STRBEFORE(?temp,\" \"),\",\" ,\"\") as ?surname)\n  bind(replace(STRAFTER(?temp,\" \"),\",\" ,\"\") as ?first_name)\n  bind(?temp as ?full_name)\n  bind(concat(?cas,\"@ucdavis.edu\") as ?email_address)\n  }\n\nlimit 5\n",
    "metadata": {}
  }
]